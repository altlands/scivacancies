@using System.Threading.Tasks
@using SciVacancies.WebApp.Engine
@using SciVacancies.WebApp.ViewModels
@model SciVacancies.WebApp.ViewModels.AccountLoginViewModel
@{
    bool isResearcher = false;
    if (!string.IsNullOrWhiteSpace(Context.Request.Cookies.Get(ConstTerms.CookiesKeyForUserRole)))
    {
        isResearcher = bool.Parse(Context.Request.Cookies.Get(ConstTerms.CookiesKeyForUserRole));
    }
}

@section scripts
{
    <script type="text/javascript">

        function setIsResearcher(value) {
            $('form').find('input[type="hidden"][name="IsResearcher"]').val(value);
        }
    </script>
}

@if (string.IsNullOrWhiteSpace(Context.Request.Cookies.Get(ConstTerms.CookiesKeyForUserName)))
{

    <div class="control control-registration">
        <a href="#" class="enter-head open-popup"><span class="dashed italic">Вход в Личный кабинет</span></a>
        <div class="sub-control">
            <a asp-controller="account" asp-action="register" class="underline">Регистрация</a>
            <a asp-controller="account" asp-action="forgotpassword" class="underline">Забыли пароль?</a>
        </div>
    </div>

    <div class="window-popup middle" style="display:none;">
        <span class="close-popup"></span>
        <div class="title-popup">
            <h4>Вход в личный кабинет</h4>
        </div>
        <div class="content-popup">
            <form asp-controller="account" asp-action="login" method="POST">
                <input type="hidden" id="IsResearcher1" name="IsResearcher" value="true" checked="checked"/>

                <div class="b-tabs">
                    <ul class="nav nav-tabs" id="tab">
                        <li>
                            <a href="#b-user" onclick="return setIsResearcher(true);">Пользователь</a>
                        </li>
                        <li>
                            <a href="#b-organization" onclick="return setIsResearcher(false);">Организация</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane" id="b-user">
                            <p>Для зарегистрированных пользователей (соискателей) - введите в форму входа логин и пароль, полученные при регистрации на Портале.</p>
                            <a asp-controller="acccount" asp-action="register" class="italic">Регистрация</a><br />
                            <a asp-controller="acccount" asp-action="forgotpassword" class="italic">Забыли пароль?</a>
                        </div>
                        <div class="tab-pane" id="b-organization">
                            <p>
                                Для входа в личный кабинет представителя Организации необходимо в соответствующие поля ввести логин и пароль, полученные на сайте <a href="#">Федеральной системы мониторинга результативности деятельности научных организаций</a> (ФСМНО)
                            </p>
                        </div>
                    </div>
                </div>

                <div class="form-line">
                    <input asp-for="Login" value="tempUser1" class="long-input" placeholder="Логин (e-mail)" />
                </div>

                <div class="form-line">
                    <input asp-for="Password" class="long-input" placeholder="Пароль" />
                </div>

                <div class="ctr-buttons">
                    <input type="submit" class="green-btn middle-icon icon-arr-right" value="Войти" />
                    <span id="cancellogin" class="blue-btn middle-icon icon-close">Отмена</span>
                </div>
            </form>
        </div>
    </div>
}
else
{
    <div class="control">
        <a asp-controller="@(isResearcher ? "researchers" : "organizations")" asp-action="account" class="cab-head">
            <span class="lk-head-icon" id="lk" rel="tooltip"></span>
            <span class="underline white italic">Личный кабинет</span>
        </a>
        <div id="lk-popover" style="display: none; text-align: center;">
            Есть новые уведомления!
        </div>
        <a asp-controller="account" asp-action="logout" class="close-head"><span class="dashed white italic">Выход</span></a>
    </div>
}
