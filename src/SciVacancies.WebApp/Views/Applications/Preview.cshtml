@using System.Threading.Tasks
@using SciVacancies.Domain.Enums
@using SciVacancies.WebApp
@model SciVacancies.WebApp.ViewModels.VacancyApplicationDetailsViewModel

<div class="crumbs">
    <a href="/">Главная</a><span class="separator">/</span>
    <a asp-controller="organizations" asp-action="account">Карточка организации</a><span class="separator">/</span>
    <a asp-controller="organizations" asp-action="vacancies">Вакансии</a><span class="separator">/</span>
    <a asp-controller="vacancies" asp-action="details" asp-route-id="@Model.VacancyGuid">@Model.Vacancy.Name</a><span class="separator">/</span>
    @ViewBag.Title
</div>

<h3>@ViewBag.Title: заявка на ID МНС6000567 №001 от @(Model.SentDate?.ToLocalVacancyDateString()) </h3>

<div class="content-slide">
    <div class="profile">
        <div class="photo inline-block">
            <img width="140" height="180" src="/images/user-photo.jpg" />
        </div>
        <div class="info info-view inline-block">
            <h4>@Model.Researcher.FullName</h4>
            <span class="int-name">@Model.Researcher.FullNameEng</span>
            <span class="block bold">Год рождения: @Model.Researcher.BirthDate.ToLocalVacancyDateString()</span>
            <span class="block"><span class="bold">Индивидуальный номер ученого:</span> 00005444</span>
            <span class="block">
                <span class="bold">Научные интересы (Государственный рубрикатор научно-технической информации):</span>
                <span>Автоматизация и автоматизированные системы в области науковедения; Библиотечное дело, библиотековедение; Информационная деятельность в области науковедения...</span>
            </span>
            <span class="small-icon icon-sm-eye"><span>Показать все (23)</span></span>
        </div>
    </div>
    <div class="list-info">
        <div class="list-item">
            <div class="bold">Образование</div>
            <ul class="table-emulation">
                <li>
                    <span class="w85 italic inline-block">Город</span> <span class="italic grey">Челябинск</span>
                </li>
                <li>
                    <span class="w85 italic inline-block">ВУЗ</span> <span class="italic grey">ЧГАКИ</span>
                </li>
                <li>
                    <span class="w85 italic inline-block">Факультет</span> <span class="italic grey">Информационных ресурсов и технологий</span>
                </li>
                <li>
                    <span class="w85 italic inline-block">Год окончания</span> <span class="italic grey">2000</span>
                </li>
            </ul>
        </div>
        <div class="list-item">
            <div class="bold">Публикации</div>
            <ol>
                <li>Научная публикация поколения 2.0: перспектива или реальность?</li>
                <li>Электронно-библиотечная система: перевод понятия на «библиотечный» английский</li>
            </ol>
            <span class="small-icon icon-sm-eye"><span>Показать все (5)</span></span>
        </div>
        <div class="list-item">
            <div class="bold">Приложенные файлы</div>
            <ol>
                <li>
                    Доклад по автоматизированным системам в области науковедения.doc<br />
                    <span class="small-icon icon-sm-download"><span>Скачать</span></span>
                </li>
                <li>
                    Резюме на английском языке.pdf<br />
                    <span class="small-icon icon-sm-download"><span>Скачать</span></span>
                </li>
            </ol>
        </div>
    </div>

    <br />
    <div class="ctr-buttons">
        @if (Model.Status == VacancyApplicationStatus.Applied && !(Model.Vacancy.Status == VacancyStatus.InCommittee || Model.Vacancy.Status == VacancyStatus.Published))
        {

            if (Model.Vacancy.WinnerResearcherGuid == Model.ResearcherGuid)
            {
                <text>
                <div class="alert alert-success" style="padding: 15px;">
                    Победитель в конкурсе на <a asp-controller="vacancies" asp-action="details" asp-route-id="@Model.VacancyGuid">вакансию</a>
                </div>
                </text>
            }

            else
            {

                if (Model.Vacancy.WinnerResearcherGuid == Guid.Empty)
                {
                    <text>
                    <a asp-controller="applications" asp-action="setwinner" asp-route-id="@Model.Guid" asp-route-iswinner="true" class="green-btn middle-icon">Выбрать победителем</a>
                    </text>
                }
                else
                {

                    if (Model.Vacancy.PretenderResearcherGuid == Model.ResearcherGuid)
                    {
                        <text>
                        <div class="alert alert-success" style="padding: 15px;">
                            Претендент на <a asp-controller="vacancies" asp-action="details" asp-route-id="@Model.VacancyGuid">вакансию</a>
                        </div>
                        </text>
                    }
                    else
                    {
                        if (Model.Vacancy.PretenderResearcherGuid == Guid.Empty)
                        {

                            <text>
                            <a asp-controller="applications" asp-action="setwinner" asp-route-id="@Model.Guid" asp-route-iswinner="false" class="green-btn middle-icon">Выбрать претендентом</a>
                            </text>
                        }
                        else
                        {
                            //у вакансии есть победитель и претендент
                        }
                    }
                }
            }

        }
    </div>



</div>

<div class="b-bottom-nav">
    <a href="/" class="small-icon icon-prev">Главная</a>
    <a asp-controller="organizations" asp-action="account" class="small-icon icon-prev">Карточка организации</a>
    <a asp-controller="organizations" asp-action="vacancies" class="small-icon icon-prev">Вакансии</a>
    <a asp-controller="vacancies" asp-action="details" asp-route-id="@Model.VacancyGuid" class="small-icon icon-prev">@Model.Vacancy.Name</a>
</div>